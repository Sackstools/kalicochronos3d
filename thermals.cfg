# =====================================================================
# thermals.cfg - Controle Térmico Avançado
# =====================================================================
# Este arquivo define todos os aquecedores, sensores térmicos e ventoinhas.

# --- Lógica da Extrusora (Fase 2 e 4 do Plano Bleeding-Edge) ---
# Contém a lógica de fluxo e térmica. O motor é definido em hardware.cfg.
[extruder]
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: tool_head:PB15
sensor_type: PT1000 # Sensor de alta precisão e alta temperatura
sensor_pin: tool_head:PC2
control: pid
pid_Kp: 28.182
pid_Ki: 1.920
pid_Kd: 103.480
min_temp: 0
max_temp: 350
# O Pressure Advance é definido aqui, mas aplicado de forma sincronizada.
# Este valor é um placeholder e DEVE ser calibrado com PRINT_PA_TOWER.
pressure_advance: 0.025
# Novo parâmetro bleeding-edge para afinar o PA.
pa_unsmooth_time: 0.02


# --- Mesa Aquecida (Fase 3 do Plano) ---
[heater_bed]
heater_pin: PA0 # Geralmente conectado a um SSR (Solid State Relay)
sensor_type: ATC Semitec 104GT-2 # Sensor de alta qualidade
sensor_pin: PC1
# Usando Model Predictive Control (MPC) para estabilidade térmica superior.
control: mpc
# Os parâmetros abaixo são placeholders e DEVEM ser obtidos com MPC_CALIBRATE.
model_coef: 336.8, 3217.5, 93.3, 1.00
model_bias: 0.1
min_temp: 0
max_temp: 130


# --- Câmara Aquecida (Fase 3 do Plano) ---
[heater_generic chamber]
heater_pin: PA1
sensor_type: Generic 3950
sensor_pin: PC0
# Usando MPC também para a câmara, ideal para grandes volumes.
control: mpc
max_power: 0.8
min_temp: 0
max_temp: 70


# --- Ventoinhas ---
[fan]
# Ventoinha de resfriamento da peça
pin: tool_head:PA8

[heater_fan hotend_fan]
# Ventoinha do dissipador do hotend, ligada a partir de 50°C.
pin: tool_head:PA9
heater: extruder
heater_temp: 50.0

[temperature_fan chamber_fan]
# Ventoinha de circulação da câmara, controlada pela temperatura.
pin: PA2
sensor_type: Generic 3950
sensor_pin: PC0
control: pid
pid_Kp: 1.0
pid_Ki: 0.5
pid_Kd: 0.5
min_temp: 0
max_temp: 70
target_temp: 65.0
